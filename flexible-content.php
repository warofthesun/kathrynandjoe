<?php

// check if the flexible content field has rows of data
if( have_rows('content_sections') ):

 	// loop through the rows of data
    while ( have_rows('content_sections') ) : the_row();

		// check current row layout
        if( get_row_layout() == 'content_block' ):
        $section_title = sanitize_title_for_query(get_sub_field('section_title') );
        $subtitle = sanitize_title_for_query(get_sub_field('subtitle') );
        ?>

        <article id="<?php if(get_sub_field('section_title') ) : echo esc_attr( $section_title ); elseif(get_sub_field('subtitle') ) : echo esc_attr( $subtitle ); else : ?>post-<?php the_ID(); ?><?php endif; ?>" <?php post_class( 'content-section' ); ?> role="article">
          <?php if(get_sub_field('section_title') ) : ?>
            <h1 class="section__title"><?php the_sub_field('section_title'); ?></h1>
          <?php endif; ?>
          <?php if(get_sub_field('subtitle') ) : ?>
            <h2 style="text-align:center;"><?php the_sub_field('subtitle'); ?></h2>
          <?php endif; ?>
          <?php if(get_sub_field('include_header_image') ) : ?>
            <?php
              $image = get_sub_field('header_image');
                // vars
              	$url = $image['url'];
              	$title = $image['title'];
              	$alt = $image['alt'];
              	$caption = $image['caption'];

              	// thumbnail
              	$size = 'header-image';
              	$thumb = $image['sizes'][ $size ];
              	$width = $image['sizes'][ $size . '-width' ];
              	$height = $image['sizes'][ $size . '-height' ]; ?>

                <img src="<?php echo $thumb; ?>" alt="<?php echo $alt; ?>" width="<?php echo $width; ?>" height="<?php echo $height; ?>" class="full-width"/>
              <?php endif; ?>
              <div class="content-section__body <?php if(get_sub_field('background_color')) : ?>background-color<?php endif; ?>" <?php if(get_sub_field('background_color')) : ?>style="background-color:<?php the_sub_field('choose_color'); ?>"<?php endif; ?>>
                <?php if (get_sub_field('number_of_columns') == 'one' ) : ?>
                  <div class="content content__single"><?php the_sub_field('content'); ?></div>
                <?php else : ?>
                  <div class="content content__double">
                    <div class="content__left"><?php the_sub_field('content_left'); ?></div>
                    <div class="content__right"><?php the_sub_field('content_right'); ?></div>
                  </div>
                <?php endif; ?>
              </div>
              <?php if(get_sub_field('background_color')) : ?>
                <svg width="1666px" height="90px" viewBox="0 0 1666 90" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="section-bottom-color">
                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <path d="M1666,72.0867045 C1663.01321,68.0390891 1659.74942,64.5452274 1656.20416,61.6525117 C1648.70215,55.5617472 1639.93787,52.2929568 1629.95639,52.3104912 C1590.51277,43.0892806 1552.00407,37.5252187 1514.56083,35.1103641 C1495.83212,33.8283935 1477.37465,33.4454901 1459.16136,33.5845997 C1440.95943,33.8496483 1422.99517,34.6217791 1405.28779,36.138843 C1387.56694,37.5553108 1370.102,39.6884462 1352.83279,42.1866212 C1335.63306,44.7551172 1319.40814,47.6773434 1304.00397,50.6646155 C1296.2514,52.1741822 1288.87108,53.6554577 1281.50515,55.1766542 C1274.41263,56.6467676 1267.33402,58.1143685 1260.26238,59.5807131 C1246.47802,62.4471736 1233.40134,65.1471715 1220.95077,67.5208586 C1203.15819,77.3692335 1185.97705,84.4408273 1169.71791,87.5886398 C1167.72469,87.935884 1165.72626,88.2479371 1163.72556,88.523684 L1160.7221,88.9106058 C1159.72058,89.0288119 1158.71543,89.0713419 1157.7112,89.1401184 C1155.69176,89.2497584 1153.72163,89.367766 1151.66327,89.364568 C1149.57998,89.3349599 1147.49932,89.2658408 1145.4232,89.1541119 C1136.95794,88.5723769 1128.23199,86.9911421 1119.17596,84.1975728 C1128.94489,83.907567 1138.15845,82.5748876 1146.82732,80.3922053 C1148.95677,79.8177981 1151.10187,79.2327319 1153.19365,78.5818281 C1155.22359,77.8785271 1157.24059,77.1483931 1159.24469,76.3924355 C1161.24981,75.6657529 1163.23132,74.7195665 1165.20167,73.855642 L1168.14282,72.5056836 C1169.11674,72.0518828 1170.08266,71.598364 1171.10599,71.0690377 C1169.88234,71.2163042 1168.7532,71.2611864 1167.59044,71.3466724 L1164.114,71.5976598 L1160.63036,71.8721475 L1157.12851,72.0249809 L1153.61846,72.2013497 C1152.4294,72.2493565 1151.17562,72.2491099 1149.95398,72.2810835 C1147.49722,72.3313563 1145.05971,72.4173359 1142.43453,72.3714672 C1132.17866,72.3825088 1120.99525,71.9310171 1108.89237,71.0480392 C1084.68394,69.3205849 1056.81146,65.7171126 1024.96725,61.757475 C1026.71357,62.5751998 1028.52409,63.1662807 1030.28956,63.9590728 C1022.60132,62.8142498 1014.89799,61.6669271 1007.14337,60.5123169 C1003.1147,59.9560171 999.132549,59.327326 995.030583,58.7928151 C990.931021,58.2410372 986.8144,57.6878396 982.676617,57.1303348 C977.409203,57.3848638 972.141753,57.3200074 966.88819,57.2516291 C961.636115,57.1973483 956.384545,56.9550564 951.128599,56.5572685 C940.605909,55.6519055 930.124491,54.6379507 919.595604,53.0323795 C914.343072,52.2413024 909.084544,51.4504368 903.827979,50.6584911 C898.574331,49.8351105 893.31645,48.9471932 888.059486,48.0279114 C882.811171,47.185139 877.571919,46.3440682 872.34573,45.5045582 C867.11924,44.6852732 861.877406,43.7695005 856.684597,43.0561634 C849.407432,42.4850775 840.182773,41.7603289 829.727079,40.940535 C824.508415,40.6081393 818.981927,40.2572909 813.238837,39.8928577 C810.361778,39.7103303 807.430612,39.5256685 804.458297,39.3374046 C801.494862,39.2034062 798.489348,39.06786 795.451749,38.9304133 C793.42125,39.2122652 787.207079,40.2430663 778.61997,41.3464513 C774.330972,41.9141546 769.484225,42.6147319 764.250174,43.1975776 C759.0252,43.8114354 753.406438,44.2936402 747.677904,44.7554598 C741.956135,45.2392767 736.081221,45.5768879 730.262961,45.6719502 C727.357161,45.7289657 724.452972,45.6878849 721.61264,45.6415194 C718.774551,45.6021499 715.976992,45.4906005 713.245495,45.2928314 C707.781502,44.8973284 702.581894,44.1609847 697.852332,42.9835596 C693.120562,41.8001482 688.910138,40.299175 685.348505,38.1729294 C677.156711,38.5548686 671.341957,38.8671113 669.006225,39.1476013 C632.743516,40.4610785 597.412122,41.3909862 562.759413,42.444519 C528.028135,43.5119411 497.154015,44.0238603 470.554977,42.8709287 C468.71776,43.5916889 467.026801,44.2304757 465.260376,44.8860744 C463.507733,45.5351226 461.7505,46.1671506 459.987641,46.7811842 C456.606321,47.9313862 453.115056,49.0561556 449.763001,49.981957 C448.101667,50.4357483 446.431501,50.8655939 444.756326,51.2663055 L442.246617,51.8399757 L439.811511,52.3139857 C438.184919,52.614944 436.551178,52.8828009 434.911254,53.1165114 C433.272259,53.3481678 431.733642,53.4731904 430.130063,53.6005044 C428.551841,53.7087311 426.918478,53.8138492 425.368537,53.8139424 C423.83031,53.8055366 422.287618,53.7548382 420.740393,53.6598282 C419.967245,53.6112961 419.192749,53.5527043 418.41687,53.4830435 C417.649706,53.4049895 416.922155,53.2861203 416.171724,53.1710903 C414.682644,52.9345504 413.188891,52.6496609 411.695392,52.3142266 C410.936464,52.1560355 410.206262,51.9604454 409.501961,51.7326094 C408.786946,51.513237 408.072442,51.2796966 407.357519,51.0340423 C405.928428,50.5356322 404.499324,50.0079117 403.073726,49.3789959 C400.22433,48.0574257 397.398411,46.5177233 394.582022,44.7037805 C386.630268,38.7441017 377.794032,34.7541764 368.345924,31.7338863 C358.82466,28.6525014 348.798546,26.6552305 339.308073,25.0433523 C320.302956,21.7860843 303.665963,20.3140994 303.567667,17.2682343 C288.346097,15.6098757 271.941465,14.4915313 254.336123,14.068463 C227.271926,26.5513469 198.621606,36.0196215 168.809715,41.0635224 C166.953437,41.3776361 165.099529,41.6734734 163.246957,41.9500599 C161.375536,42.2313541 159.470716,42.5016979 157.589079,42.7479774 C153.808919,43.2441641 150.061842,43.6552945 146.283303,43.9957737 C138.587744,44.7230563 131.055129,45.0696154 123.20736,45.1857297 C121.263973,45.2087976 119.322747,45.207532 117.381717,45.1830129 C115.423244,45.1459699 113.462738,45.1079878 111.500267,45.0710858 C107.5403,44.9681957 103.584083,44.7711767 99.6274088,44.4741128 C95.6540593,44.1867336 91.5674866,43.8659517 87.5391293,43.4056588 C85.5180945,43.1797971 83.4951879,42.9287334 81.4713389,42.6504137 C79.4103507,42.3976612 77.3396001,42.1230173 75.2708706,41.820002 C57.8667529,47.9989124 40.0272659,55.5930225 22.3233695,64.7358214 C18.3041466,66.8262553 14.6289173,69.0551522 11.220998,71.4909134 C7.7883859,73.9649422 4.66899558,76.5845836 1.84424473,79.333311 C1.21403518,79.9476307 0.59959706,80.5661543 -3.49771878e-11,81.1900861 L0,0 L1666,0 L1666,72.0867045 Z" id="section-bottom-color" fill="<?php the_sub_field('choose_color'); ?>" fill-rule="nonzero"></path>
                    </g>
                </svg>
              <?php endif; ?>
        </article>

  <?php endif;

    endwhile; else :
endif;

?>
